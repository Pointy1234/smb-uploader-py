@echo off
REM SMB3 File Processor - –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫ –¥–ª—è Windows
REM –í–µ—Ä—Å–∏—è: 1.0

title SMB3 File Processor - Windows Launcher

echo.
echo  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ïó‚ñà‚ñà‚ïó     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó
echo  ‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ïö‚ïê‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó    ‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù
echo  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ñà‚ñà‚ñà‚ñà‚ïî‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù ‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  
echo  ‚ïö‚ïê‚ïê‚ïê‚ïê‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó ‚ïö‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó    ‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù  
echo  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë ‚ïö‚ïê‚ïù ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù    ‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó
echo  ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïù     ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù     ‚ïö‚ïê‚ïù     ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
echo.
echo  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó 
echo  ‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó
echo  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù
echo  ‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïù ‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù  ‚ïö‚ïê‚ïê‚ïê‚ïê‚ñà‚ñà‚ïë‚ïö‚ïê‚ïê‚ïê‚ïê‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó
echo  ‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë
echo  ‚ïö‚ïê‚ïù     ‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù  ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù
echo.
echo         SMB3 File Processor –¥–ª—è Windows - –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫
echo         ================================================
echo.

:MENU
echo üìã –í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:
echo.
echo  1. üöÄ –ó–∞–ø—É—Å–∫ —Å Docker (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
echo  2. üêç –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ (Python)
echo  3. üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ SMB3 –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
echo  4. ‚öôÔ∏è  –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (.env)
echo  5. üìä –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ Docker
echo  6. üõë –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Ä–≤–∏—Å–∞
echo  7. üîß –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã
echo  8. üíª –û—Ç–∫—Ä—ã—Ç—å –≤ VS Code
echo  9. üìñ –ü–æ–∫–∞–∑–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
echo  0. ‚ùå –í—ã—Ö–æ–¥
echo.
set /p choice="–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä (0-9): "

if "%choice%"=="1" goto DOCKER_START
if "%choice%"=="2" goto LOCAL_START
if "%choice%"=="3" goto TEST_SMB3
if "%choice%"=="4" goto SETUP_CONFIG
if "%choice%"=="5" goto SHOW_LOGS
if "%choice%"=="6" goto STOP_SERVICE
if "%choice%"=="7" goto DIAGNOSTICS
if "%choice%"=="8" goto OPEN_VSCODE
if "%choice%"=="9" goto SHOW_DOCS
if "%choice%"=="0" goto EXIT
echo –ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.
pause
goto MENU

:DOCKER_START
echo.
echo üê≥ –ó–∞–ø—É—Å–∫ —Å Docker...
echo =====================

REM –ü—Ä–æ–≤–µ—Ä–∫–∞ Docker
where docker >nul 2>nul
if errorlevel 1 (
    echo ‚ùå Docker –Ω–µ –Ω–∞–π–¥–µ–Ω!
    echo    –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Docker Desktop for Windows
    pause
    goto MENU
)

REM –ü—Ä–æ–≤–µ—Ä–∫–∞ .env
if not exist .env (
    echo üìã –°–æ–∑–¥–∞–Ω–∏–µ .env –∏–∑ —à–∞–±–ª–æ–Ω–∞...
    if exist .env.example (
        copy .env.example .env
        echo ‚ö†Ô∏è  –§–∞–π–ª .env —Å–æ–∑–¥–∞–Ω. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã SMB3!
        notepad .env
    ) else (
        echo ‚ùå –§–∞–π–ª .env.example –Ω–µ –Ω–∞–π–¥–µ–Ω!
        pause
        goto MENU
    )
)

REM –í—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞
echo.
echo –í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º Docker:
echo  1. –° –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–æ–º (–æ–±—ã—á–Ω—ã–π)
echo  2. Offline —Ä–µ–∂–∏–º (–±–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞)
set /p docker_choice="–í–≤–µ–¥–∏—Ç–µ 1 –∏–ª–∏ 2: "

if "%docker_choice%"=="1" (
    echo üîó –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ —Å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–æ–º...
    docker-compose up --build -d
) else (
    echo üîí –ó–∞–ø—É—Å–∫ –≤ offline —Ä–µ–∂–∏–º–µ...
    docker-compose -f docker-compose.offline.yml up --build -d
)

if errorlevel 1 (
    echo ‚ùå –û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ Docker!
    pause
    goto MENU
)

echo ‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–∞...
timeout /t 15 /nobreak >nul

echo üè• –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏...
powershell -Command "try { $result = Invoke-RestMethod http://localhost:3000/health -TimeoutSec 10; Write-Host '‚úÖ –°–µ—Ä–≤–∏—Å –∑–∞–ø—É—â–µ–Ω —É—Å–ø–µ—à–Ω–æ!' -ForegroundColor Green; Write-Host ('–°—Ç–∞—Ç—É—Å: ' + $result.status) -ForegroundColor Cyan } catch { Write-Host '‚ö†Ô∏è –°–µ—Ä–≤–∏—Å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏' -ForegroundColor Yellow }"

echo.
echo üéâ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–ø—É—â–µ–Ω!
echo üåê –°–µ—Ä–≤–∏—Å –¥–æ—Å—Ç—É–ø–µ–Ω: http://localhost:3000
echo üìä –î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ª–æ–≥–æ–≤ –≤—ã–±–µ—Ä–∏—Ç–µ –ø—É–Ω–∫—Ç 5 –≤ –º–µ–Ω—é
pause
goto MENU

:LOCAL_START
echo.
echo üêç –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫...
echo =====================

REM –ü—Ä–æ–≤–µ—Ä–∫–∞ Python
python --version >nul 2>nul
if errorlevel 1 (
    echo ‚ùå Python –Ω–µ –Ω–∞–π–¥–µ–Ω!
    echo    –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Python –∏ –¥–æ–±–∞–≤—å—Ç–µ –≤ PATH
    pause
    goto MENU
)

REM –ü—Ä–æ–≤–µ—Ä–∫–∞ .env
if not exist .env (
    echo üìã –°–æ–∑–¥–∞–Ω–∏–µ .env –∏–∑ —à–∞–±–ª–æ–Ω–∞...
    if exist .env.example (
        copy .env.example .env
        echo ‚ö†Ô∏è  –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã SMB3 –≤ .env!
        notepad .env
    ) else (
        echo ‚ùå –§–∞–π–ª .env.example –Ω–µ –Ω–∞–π–¥–µ–Ω!
        pause
        goto MENU
    )
)

REM –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
echo üì¶ –ü—Ä–æ–≤–µ—Ä–∫–∞ Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π...
pip show flask >nul 2>nul
if errorlevel 1 (
    echo üì• –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π...
    pip install -r requirements.txt
    if errorlevel 1 (
        echo ‚ùå –û—à–∏–±–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π!
        pause
        goto MENU
    )
)

echo üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...
echo ‚ö†Ô∏è  –î–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–∞–∂–º–∏—Ç–µ Ctrl+C
python app.py
pause
goto MENU

:TEST_SMB3
echo.
echo üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ SMB3 –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è...
echo ===================================

REM –ü—Ä–æ–≤–µ—Ä–∫–∞ Python
python --version >nul 2>nul
if errorlevel 1 (
    echo ‚ùå Python –Ω–µ –Ω–∞–π–¥–µ–Ω!
    pause
    goto MENU
)

REM –ü—Ä–æ–≤–µ—Ä–∫–∞ .env
if not exist .env (
    echo ‚ùå –§–∞–π–ª .env –Ω–µ –Ω–∞–π–¥–µ–Ω!
    echo    –°–Ω–∞—á–∞–ª–∞ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é (–ø—É–Ω–∫—Ç 4)
    pause
    goto MENU
)

REM –ü—Ä–æ–≤–µ—Ä–∫–∞ test_smb3.py
if not exist test_smb3.py (
    echo ‚ùå –§–∞–π–ª test_smb3.py –Ω–µ –Ω–∞–π–¥–µ–Ω!
    pause
    goto MENU
)

echo üîå –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–µ—Å—Ç–∞ SMB3...
python test_smb3.py
if errorlevel 1 (
    echo.
    echo ‚ùå –¢–µ—Å—Ç SMB3 –Ω–µ –ø—Ä–æ—à–µ–ª!
    echo üîß –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
    echo    - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ .env —Ñ–∞–π–ª–µ
    echo    - –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å SMB3 —Å–µ—Ä–≤–µ—Ä–∞
    echo    - –ü—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –ª–æ–≥–∏–Ω–∞/–ø–∞—Ä–æ–ª—è
    echo    - –í–∫–ª—é—á–µ–Ω –ª–∏ SMB3 –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
) else (
    echo.
    echo ‚úÖ –¢–µ—Å—Ç SMB3 –ø—Ä–æ—à–µ–ª —É—Å–ø–µ—à–Ω–æ!
    echo üéâ SMB3 File Processor –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ
)
pause
goto MENU

:SETUP_CONFIG
echo.
echo ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏...
echo =============================

if not exist .env.example (
    echo ‚ùå –§–∞–π–ª .env.example –Ω–µ –Ω–∞–π–¥–µ–Ω!
    pause
    goto MENU
)

if not exist .env (
    echo üìã –°–æ–∑–¥–∞–Ω–∏–µ .env –∏–∑ —à–∞–±–ª–æ–Ω–∞...
    copy .env.example .env
)

echo üìù –û—Ç–∫—Ä—ã—Ç–∏–µ .env –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è...
echo.
echo üí° –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
echo    SMB_HOST     - IP –∞–¥—Ä–µ—Å SMB3 —Å–µ—Ä–≤–µ—Ä–∞
echo    SMB_SHARE    - –ò–º—è SMB3 —à–∞—Ä—ã
echo    SMB_USERNAME - –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
echo    SMB_PASSWORD - –ü–∞—Ä–æ–ª—å
echo    SMB_DOMAIN   - –î–æ–º–µ–Ω (–∏–ª–∏ WORKGROUP)
echo    API_URL      - URL –≤–∞—à–µ–≥–æ API —Å–µ—Ä–≤–µ—Ä–∞
echo.
notepad .env
echo ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞
pause
goto MENU

:SHOW_LOGS
echo.
echo üìä –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤...
echo ====================

REM –ü—Ä–æ–≤–µ—Ä–∫–∞ Docker
where docker >nul 2>nul
if errorlevel 1 (
    echo ‚ùå Docker –Ω–µ –Ω–∞–π–¥–µ–Ω!
    pause
    goto MENU
)

echo –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –ª–æ–≥–æ–≤:
echo  1. –û–±—ã—á–Ω—ã–π —Ä–µ–∂–∏–º
echo  2. Offline —Ä–µ–∂–∏–º
echo  3. –°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
set /p log_choice="–í–≤–µ–¥–∏—Ç–µ 1, 2 –∏–ª–∏ 3: "

if "%log_choice%"=="1" (
    echo üìã –õ–æ–≥–∏ –æ–±—ã—á–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞...
    docker-compose logs -f --tail=50 smb-processor
) else if "%log_choice%"=="2" (
    echo üìã –õ–æ–≥–∏ offline —Ä–µ–∂–∏–º–∞...
    docker-compose -f docker-compose.offline.yml logs -f --tail=50 smb-processor
) else if "%log_choice%"=="3" (
    echo üìä –°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤...
    docker ps -a
    echo.
    docker-compose ps
    pause
) else (
    echo –ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä
    pause
)
goto MENU

:STOP_SERVICE
echo.
echo üõë –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Ä–≤–∏—Å–∞...
echo =======================

REM –ü—Ä–æ–≤–µ—Ä–∫–∞ Docker
where docker >nul 2>nul
if errorlevel 1 (
    echo ‚ùå Docker –Ω–µ –Ω–∞–π–¥–µ–Ω!
    pause
    goto MENU
)

echo –ö–∞–∫–æ–π —Å–µ—Ä–≤–∏—Å –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å?
echo  1. –û–±—ã—á–Ω—ã–π —Ä–µ–∂–∏–º
echo  2. Offline —Ä–µ–∂–∏–º
echo  3. –í—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
set /p stop_choice="–í–≤–µ–¥–∏—Ç–µ 1, 2 –∏–ª–∏ 3: "

if "%stop_choice%"=="1" (
    echo üõë –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–±—ã—á–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞...
    docker-compose down
) else if "%stop_choice%"=="2" (
    echo üõë –û—Å—Ç–∞–Ω–æ–≤–∫–∞ offline —Ä–µ–∂–∏–º–∞...
    docker-compose -f docker-compose.offline.yml down
) else if "%stop_choice%"=="3" (
    echo üõë –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤...
    docker stop $(docker ps -q) 2>nul
    docker-compose down 2>nul
    docker-compose -f docker-compose.offline.yml down 2>nul
) else (
    echo –ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä
    pause
    goto MENU
)

echo ‚úÖ –°–µ—Ä–≤–∏—Å –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
pause
goto MENU

:DIAGNOSTICS
echo.
echo üîß –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã...
echo =========================

echo üìã –°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:
echo ========================
echo –î–∞—Ç–∞/–≤—Ä–µ–º—è: %date% %time%
echo –ö–æ–º–ø—å—é—Ç–µ—Ä: %COMPUTERNAME%
echo –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: %USERNAME%
echo.

echo üêç –ü—Ä–æ–≤–µ—Ä–∫–∞ Python:
python --version 2>nul
if errorlevel 1 (
    echo ‚ùå Python –Ω–µ –Ω–∞–π–¥–µ–Ω
) else (
    echo ‚úÖ Python —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
    where python
)
echo.

echo üê≥ –ü—Ä–æ–≤–µ—Ä–∫–∞ Docker:
docker --version 2>nul
if errorlevel 1 (
    echo ‚ùå Docker –Ω–µ –Ω–∞–π–¥–µ–Ω
) else (
    echo ‚úÖ Docker —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
    docker version --format "Server: {{.Server.Version}}, Client: {{.Client.Version}}" 2>nul
)
echo.

echo üìÅ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞:
if exist app.py (echo ‚úÖ app.py) else (echo ‚ùå app.py –Ω–µ –Ω–∞–π–¥–µ–Ω)
if exist requirements.txt (echo ‚úÖ requirements.txt) else (echo ‚ùå requirements.txt –Ω–µ –Ω–∞–π–¥–µ–Ω)
if exist .env (echo ‚úÖ .env) else (echo ‚ö†Ô∏è .env –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)
if exist .env.example (echo ‚úÖ .env.example) else (echo ‚ùå .env.example –Ω–µ –Ω–∞–π–¥–µ–Ω)
if exist test_smb3.py (echo ‚úÖ test_smb3.py) else (echo ‚ùå test_smb3.py –Ω–µ –Ω–∞–π–¥–µ–Ω)
echo.

echo üåê –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ç–∏:
if defined SMB_HOST (
    echo –ü—Ä–æ–≤–µ—Ä–∫–∞ SMB_HOST –∏–∑ .env...
    ping -n 1 %SMB_HOST% >nul 2>nul
    if errorlevel 1 (
        echo ‚ùå SMB —Å–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
    ) else (
        echo ‚úÖ SMB —Å–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω
    )
) else (
    echo ‚ö†Ô∏è SMB_HOST –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ .env
)

echo üîå –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–æ–≤:
netstat -an | findstr ":3000 " >nul
if errorlevel 1 (
    echo ‚ö†Ô∏è –ü–æ—Ä—Ç 3000 –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
) else (
    echo ‚úÖ –ü–æ—Ä—Ç 3000 –∑–∞–Ω—è—Ç (–≤–æ–∑–º–æ–∂–Ω–æ, —Å–µ—Ä–≤–∏—Å –∑–∞–ø—É—â–µ–Ω)
)

echo.
echo üìä –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞
pause
goto MENU

:OPEN_VSCODE
echo.
echo üíª –û—Ç–∫—Ä—ã—Ç–∏–µ –≤ VS Code...
echo ========================

where code >nul 2>nul
if errorlevel 1 (
    echo ‚ùå VS Code –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ PATH!
    echo    –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ VS Code –∏–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –∏–∑ –ø–∞–ø–∫–∏ VS Code
    pause
    goto MENU
)

echo üöÄ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ VS Code –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞...
if exist setup_vscode.ps1 (
    powershell -ExecutionPolicy Bypass -File setup_vscode.ps1
)

echo üìÇ –û—Ç–∫—Ä—ã—Ç–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –≤ VS Code...
code .

echo ‚úÖ VS Code –∑–∞–ø—É—â–µ–Ω!
echo üí° –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –≤ VS Code:
echo    F5               - –ó–∞–ø—É—Å–∫ –æ—Ç–ª–∞–¥–∫–∏
echo    Ctrl + Shift + P - –ö–æ–º–∞–Ω–¥–Ω–∞—è –ø–∞–ª–∏—Ç—Ä–∞  
echo    Ctrl + Shift + ` - –ù–æ–≤—ã–π —Ç–µ—Ä–º–∏–Ω–∞–ª
echo    Ctrl + R         - –ó–∞–ø—É—Å–∫ –∑–∞–¥–∞—á–∏
pause
goto MENU

:SHOW_DOCS
echo.
echo üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è...
echo ==================

echo üìã –î–æ—Å—Ç—É–ø–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
echo.
if exist README_smb_processor.md (
    echo ‚úÖ README_smb_processor.md - –û—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
)
if exist WINDOWS_COMMANDS.md (
    echo ‚úÖ WINDOWS_COMMANDS.md - –ö–æ–º–∞–Ω–¥—ã –¥–ª—è Windows
)
if exist OFFLINE_INSTALL_GUIDE.md (
    echo ‚úÖ OFFLINE_INSTALL_GUIDE.md - –ê–≤—Ç–æ–Ω–æ–º–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞
)
if exist QUICK_START_SMB3.md (
    echo ‚úÖ QUICK_START_SMB3.md - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
)

echo.
echo –ö–∞–∫–æ–π —Ñ–∞–π–ª –æ—Ç–∫—Ä—ã—Ç—å?
echo  1. –û—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
echo  2. Windows –∫–æ–º–∞–Ω–¥—ã
echo  3. –ê–≤—Ç–æ–Ω–æ–º–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞
echo  4. –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
echo  5. –í—Å–µ —Ñ–∞–π–ª—ã –≤ –ø—Ä–æ–≤–æ–¥–Ω–∏–∫–µ
set /p doc_choice="–í–≤–µ–¥–∏—Ç–µ 1-5: "

if "%doc_choice%"=="1" (
    if exist README_smb_processor.md (start README_smb_processor.md)
) else if "%doc_choice%"=="2" (
    if exist WINDOWS_COMMANDS.md (start WINDOWS_COMMANDS.md)
) else if "%doc_choice%"=="3" (
    if exist OFFLINE_INSTALL_GUIDE.md (start OFFLINE_INSTALL_GUIDE.md)
) else if "%doc_choice%"=="4" (
    if exist QUICK_START_SMB3.md (start QUICK_START_SMB3.md)
) else if "%doc_choice%"=="5" (
    explorer .
) else (
    echo –ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä
)
pause
goto MENU

:EXIT
echo.
echo üëã –î–æ —Å–≤–∏–¥–∞–Ω–∏—è!
echo –°–ø–∞—Å–∏–±–æ –∑–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ SMB3 File Processor
timeout /t 2 /nobreak >nul
exit /b

REM –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
:ERROR
echo ‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞!
pause
goto MENU
